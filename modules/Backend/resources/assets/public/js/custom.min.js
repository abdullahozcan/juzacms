function ajaxRequest(e,t=null,a={}){let i=$.ajax({type:a.method||"POST",url:e,dataType:a.dataType||"json",data:t,cache:!1,async:void 0===a.async||a.async});return i.done((function(e){a.callback&&a.callback(e)})),i.fail((function(e){a.failCallback&&a.failCallback(e)})),i.responseJSON}function replace_template(e,t){return e.replace(/{(\w*)}/g,(function(e,a){return t.hasOwnProperty(a)?t[a]:""}))}function process_each(e,t,a,i={}){let n=0,o=e.length;!function s(){let l=t.call(e[n++]);n<o?setTimeout(s,a):i.completeCallback&&i.completeCallback(l)}()}function random_string(e){let t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i=a.length;for(let n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*i));return t}function toastr_message(e,t,a=null){1==t?toastr.success(e,a||juzaweb.lang.successfully+" !!"):toastr.error(e,a||juzaweb.lang.error+" !!")}function confirm_message(e,t){Swal.fire({title:"",text:e,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:juzaweb.lang.yes+"!",cancelButtonText:juzaweb.lang.cancel+"!"}).then((e=>{t(e.value)}))}function show_message(e){if(e.data)return e.data.message&&toastr_message(e.data.message,e.status),!1;if(e.responseJSON)if(e.responseJSON.errors)$.each(e.responseJSON.errors,(function(e,t){return toastr_message(t[0],!1),!1}));else if(e.responseJSON.message)return toastr_message(e.responseJSON.message,!1),!1;e.message&&toastr_message(e.message.message,!1)}$(document).on("turbolinks:load",(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).ajaxError((function(e,t,a,i){401===t.status&&Turbolinks.visit("/"),419===t.status&&Turbolinks.visit(location.toString())}))})),toastr.options.timeOut=3e3,$(document).on("turbolinks:load",(function(){$("body").on("click",".custom-seo",(function(){let e=$(this),t=$("input[name=title]").val(),a=tinyMCE.activeEditor.getContent();if($("#meta_title").val()&&$("#meta_description").val())return e.hide("slow"),$(".box-custom-seo").show("slow"),!1;$.ajax({type:"POST",url:juzaweb.adminUrl+"/ajax/seo-content",dataType:"json",data:{title:t,description:a}}).done((function(t){return!1===t.status?(show_message(t),!1):($("#meta_title").val()||$("#meta_title").val(t.title),$("#meta_description").val()||$("#meta_description").val(t.description),$("#meta_title").val()||$(".review-title").text(t.title),$("#meta_description").val()||$(".review-description").text(t.description),e.hide("slow"),$(".box-custom-seo").show("slow"),!1)})).fail((function(e){return show_message(e),!1}))})),$("input[name=title], textarea[name=content]").on("change",(function(){let e=$("input[name=title]").val(),t=tinyMCE.activeEditor.getContent();$.ajax({type:"POST",url:juzaweb.adminUrl+"/ajax/seo-content",dataType:"json",data:{title:e,description:t}}).done((function(e){return!1===e.status?(show_message(e),!1):($("#meta_title").val()||$(".review-title").text(e.title),$("#meta_description").val()||$(".review-description").text(e.description),!1)})).fail((function(e){return show_message(e),!1}))})),$("form").on("change","input[name=slug]",(function(){let e=$(this).val();$(".review-url span").text(e)})),$("#meta_title, #meta_description, #meta_url").on("change",(function(){let e=$("#meta_title").val(),t=$("#meta_description").val();$.ajax({type:"POST",url:juzaweb.adminUrl+"/ajax/seo-content",dataType:"json",data:{title:e,description:t}}).done((function(e){return!1===e.status?(show_message(e.message),!1):($(".review-title").text(e.title),$(".review-description").text(e.description),!1)})).fail((function(e){return show_message(e),!1}))}))}));let juzawebFileManager=function(e,t){let a=e.type||"image",i=e.prefix,n=e.multichoose||!1;"/"!==i[0]&&(i="/"+i);let o=void 0!==window.screenLeft?window.screenLeft:window.screenX,s=e.width?e.width:800,l=e.height?e.height:500,d=void 0!==window.screenTop?window.screenTop:window.screenY,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,c=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,u=r/window.screen.availWidth,m=(r-s)/2/u+o,h=(c-l)/2/u+d;window.open(i+"?type="+a+(n?"&multichoose=1":""),"File Manager","scrollbars=yes, width="+s/u+", height="+l/u+", top="+h+", left="+m),window.SetUrl=t};function jwUpdateProcess(e,t=null,a=0,i="primary"){t&&$(e+" .process-text").append(`<li class="text-${i}">${t}</li>`),a&&$(e+" .progress-bar").attr("aria-valuenow",a).text(a+"%").css("width",a+"%")}function jwCMSUpdate(e,t,a=null,i={},n=null,o=null){let s=juzaweb.adminUrl+"/update/"+e+"/__STEP__";a&&jwUpdateProcess(a,juzaweb.lang.update_process["step"+t].before),ajaxRequest(s.replace("__STEP__",t),i,{method:"POST",callback:function(s){if(0==s.status)return o&&o(s),a&&jwUpdateProcess(a,s.data.message,0,"danger"),!1;s.data.next_url?(a&&jwUpdateProcess(a,null,17*t),jwCMSUpdate(e,t+1,a,i,n,o)):(n&&n(s),a&&jwUpdateProcess(a,juzaweb.lang.update_process.done,100,"success"))},failCallback:function(e){let i=e.message||"Server Error";o&&o(e),a&&jwUpdateProcess(a,i,15*t,"danger")}})}function recursiveUpdate(e,t,a=0,i=null,n=null){let o={};o="theme"==e?{theme:t[a]}:{plugin:t[a]},jwCMSUpdate(e,1,"#"+e+"-"+t[a].replace("/","_")+"-update-process",o,(function(o){t[a+1]?recursiveUpdate(e,t,a+1,i,n):i&&i(o)}),(function(o){n&&n(o),t[a+1]&&recursiveUpdate(e,t,a+1,i,n)}))}function initSelect2(e="body"){$(e+" .select2").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}}}),$(e+" .select2-default").select2({width:$(this).data("width")||"100%",dropdownAutoWidth:!$(this).data("width")}),$(e+" .load-taxonomies").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:juzaweb.adminUrl+"/load-data/loadTaxonomies",dataType:"json",data:function(e){let t=$(this).data("post-type"),a=$(this).data("taxonomy"),i=$(this).data("explodes");return i&&(i=$("."+i).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:i,post_type:t,taxonomy:a}}}}),$(e+" .load-users").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/admin-cp/load-data/loadUsers",dataType:"json",data:function(e){let t=$(this).data("explodes")?$(this).data("explodes"):null;return t&&(t=$("."+t).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:t}}}}),$(e+" .load-menu").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/admin-cp/load-data/loadMenu",dataType:"json",data:function(e){let t=$(this).data("explodes")?$(this).data("explodes"):null;return t&&(t=$("."+t).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:t}}}}),$(e+" .load-pages").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/admin-cp/load-data/loadPages",dataType:"json",data:function(e){return{search:$.trim(e.term),page:e.page}}}}),$(e+" .load-locales").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:"/admin-cp/load-data/loadLocales",dataType:"json",data:function(e){return{search:$.trim(e.term),page:e.page}}}}),$(e+" .load-select2").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:$(this).data("url")||"",dataType:"json",data:function(e){return{search:$.trim(e.term),page:e.page}}}}),$(e+" .load-resources").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:juzaweb.adminUrl+"/load-data/loadResource",dataType:"json",data:function(e){let t=$(this).data("type"),a=$(this).data("explodes");return a&&(a=$("."+a).map((function(){return $(this).val()})).get()),{search:$.trim(e.term),page:e.page,explodes:a,type:t}}}}),$(e+" .load-subscription-objects").select2({allowClear:!0,dropdownAutoWidth:!$(this).data("width"),width:$(this).data("width")||"100%",placeholder:function(e){return{id:null,text:e.placeholder}},ajax:{method:"GET",url:juzaweb.adminUrl+"/load-data/loadSubscriptionObjects",dataType:"json",data:function(e){let t=$(this).data("module");return{search:$.trim(e.term),page:e.page,module:t}}}})}$.fn.filemanager=function(e,t){let a=this,i=juzaweb.adminPrefix+"/file-manager";this.on("click",(function(t){juzawebFileManager({type:e,prefix:i},(function(e){let t=e[0];if(a.data("input")){$("#"+a.data("input")).val(t.path)}if(a.data("preview")){$("#"+a.data("preview")).html('<img src="'+t.url+'" alt="'+t.name+'">')}if(a.data("name")){$("#"+a.data("name")).html(t.name)}}))}))},$(document).on("turbolinks:load",(function(){$("body").on("click",".file-manager",(function(){let e=$(this).data("type")||"image",t=$(this).data("input"),a=$(this).data("preview"),i=$(this).data("name"),n=juzaweb.adminPrefix+"/file-manager";juzawebFileManager({type:e,prefix:n},(function(e){let n=e[0];if(t){$("#"+t).val(n.path)}if(a){$("#"+a).html('<img src="'+n.url+'" alt="">')}if(i){$("#"+i).html(n.name)}}))})),$("body").on("click",".form-image",(function(){let e=$(this),t=e.find(".input-path"),a=e.find(".dropify-render"),i=e.find(".dropify-filename-inner"),n=juzaweb.adminPrefix+"/file-manager";juzawebFileManager({type:"image",prefix:n},(function(n){let o=n[0];t.val(o.path),a.html('<img src="'+o.url+'" alt="">'),i.html(o.name),e.addClass("previewing"),e.find(".image-hidden").show()}))})),$("body").on("click",".form-image .image-clear",(function(){let e=$(this).closest(".form-image"),t=e.find(".input-path"),a=e.find(".dropify-render"),i=e.find(".dropify-filename-inner");t.val(""),a.html(""),i.html(""),e.removeClass("previewing"),e.find(".image-hidden").hide()})),$("body").on("click",".add-image-images",(function(){let e=juzaweb.adminPrefix+"/file-manager",t=$(this).closest(".form-images"),a=t.find(".input-name").val();juzawebFileManager({type:"image",prefix:e,multichoose:!0},(function(e){let i=document.getElementById("form-images-template").innerHTML,n="";$.each(e,(function(e,t){n+=replace_template(i,{name:a,url:t.url,path:t.path})})),t.find(".images-list .image-item:last").before(n)}))})),$("body").on("click",".form-images .remove-image-item",(function(){$(this).closest(".image-item").remove()}))})),$(document).on("turbolinks:load",(function(){$(".jw-widget-builder").nestable({noDragClass:"dd-nodrag",maxDepth:1}),$("#widget-container").on("click",".dropdown-action",(function(){let e=$(this).closest(".widget-block").find(".sidebar-blocks");e.is(":hidden")?e.show():e.hide()})),$("#widget-container").on("submit",".form-add-widget",(function(){let e=$(this).serialize(),t=$(this).find("button[type=submit]"),a=t.find("i").attr("class");return t.find("i").attr("class","fa fa-spinner fa-spin"),t.prop("disabled",!0),ajaxRequest(juzaweb.adminUrl+"/widgets/get-item",e,{method:"GET",callback:function(e){let i=e.items||[];$.each(i,(function(e,t){$("#sidebar-"+e+" .jw-widget-builder .dd-empty").remove(),$("#sidebar-"+e+" .dd-list").append(t.html)})),$.each(i,(function(e,t){initSelect2("#dd-item-"+t.key)})),t.find("i").attr("class",a),t.prop("disabled",!1)},failCallback:function(){show_message(response),t.find("i").attr("class",a),t.prop("disabled",!1)}}),!1})),$("#widget-container").on("click",".widget-sidebar-item",(function(){let e=$(this),t=e.find("input").is(":checked"),a=e.closest(".form-add-widget"),i=a.find("button[type=submit]");t?(e.find("span").html(""),e.find("input").prop("checked",!1)):(e.find("span").html('<i class="fa fa-check"></i>'),e.find("input").prop("checked",!0)),a.find(".widget-sidebar-item input:checked").length>0?i.prop("disabled",!1):i.prop("disabled",!0)})),$("#widget-container").on("click",".show-edit-form",(function(){let e=$(this).closest(".sidebar-item").find(".card-body");e.is(":hidden")?e.show():e.hide()})),$("#widget-container").on("click",".show-item-form",(function(){let e=$(this).closest(".dd-item").find(".form-item-edit");e.is(":hidden")?e.show():e.hide()})),$("#widget-container").on("click",".delete-item-form",(function(){$(this).closest(".dd-item").remove()}))})),$(document).on("turbolinks:load",(function(){$("#media-container").on("click",".show-form-upload",(function(){let e=$(".media-upload-form");e.is(":hidden")?e.show("slow"):e.hide("slow")}))})),$(document).on("turbolinks:load",(function(){var e=function(e){var t=e.length?e:$(e.target);window.JSON?$("#items-output").val(window.JSON.stringify(t.nestable("serialize"))):alert("JSON browser support required for this application.")};$("#jw-menu-builder").nestable({noDragClass:"dd-nodrag"}).on("change",e),e($("#jw-menu-builder")),$("#menu-container").on("submit",".form-menu-block",(function(t){if(t.isDefaultPrevented())return!1;t.preventDefault();var a=$(this),i=new FormData(a[0]),n=a.find("button[type=submit]"),o=n.find("i").attr("class");n.find("i").attr("class","fa fa-spinner fa-spin"),n.prop("disabled",!0),$.ajax({type:a.attr("method"),url:a.attr("action"),dataType:"json",data:i,cache:!1,contentType:!1,processData:!1}).done((function(t){if(n.find("i").attr("class",o),n.prop("disabled",!1),!1===t.status)return show_message(t),!1;let i=t.data.items;return i.length>0&&($("#jw-menu-builder .dd-empty").remove(),$.each(i,(function(e,t){$("#jw-menu-builder .dd-list:first").append(t)}))),e($("#jw-menu-builder")),a.find(".reset-after-add").val(""),!1})).fail((function(e){return n.find("i").attr("class",o),n.prop("disabled",!1),show_message(e),!1}))})),$("#menu-container").on("click",".btn-add-menu",(function(){let e=$(".form-add-menu");e.is(":hidden")?e.show("slow"):e.hide("slow")})),$("#menu-container").on("change",".form-select-menu .load-menu",(function(){let e=$(this).val();e&&(window.location=juzaweb.adminUrl+"/menus/"+e)})),$("#menu-container").on("click",".card-menu-show",(function(){let e=$(this).closest(".card-menu-items").find(".card-body");e.is(":hidden")?($(".card-menu-items").find(".card-body").slideUp("slow"),$(".card-menu-items").find(".card-header").removeClass("bg-light"),$(this).closest(".card-menu-items").find(".card-header").addClass("bg-light"),e.slideDown("slow")):(e.slideUp("slow"),$(this).closest(".card-menu-items").find(".card-header").removeClass("bg-light"))})),$("#menu-container").on("click",".show-menu-edit",(function(e){let t=$(this).closest(".dd-item").find(".form-item-edit").first();t.is(":hidden")?t.slideDown("slow"):t.slideUp("slow")})),$("#menu-container").on("click",".delete-menu",(function(e){let t=$(this).data("id");confirm_message(juzaweb.lang.remove_question.replace(":name",juzaweb.lang.menu),(function(e){e&&ajaxRequest(juzaweb.adminUrl+"/menus/"+t,{},{method:"DELETE",callback:function(e){show_message(e),window.location=juzaweb.adminUrl+"/menus"}})}))})),$("#menu-container").on("change",".menu-data",(function(){let t=$(this).data("name"),a=$(this).val();$(this).closest("li").data(t,a),e($("#jw-menu-builder")),$(this).hasClass("change-label")&&$(this).closest("li").find(".dd-handle span:first").text(a)})),$("#menu-container").on("click",".delete-menu-item",(function(){$(this).closest("li").remove(),e($("#jw-menu-builder"))})),$("#menu-container").on("click",".close-menu-item",(function(){let e=$(this).closest(".dd-item").find(".form-item-edit").first();e.is(":hidden")?e.slideDown("slow"):e.slideUp("slow")})),$("#menu-container").on("change",".select-all-checkbox",(function(){let e=$(this).data("select"),t=$(this).is(":checked");$(this).closest(".tab-pane").find("."+e).prop("checked",t)})),$("#menu-container").on("keyup",".menu-box-post-type-search",(function(){let e=$(this).val(),t=$(this).data("key"),a=$(this).data("post_type"),i=$(this).closest(".tab-pane").find(".box-tab-search-result");return i.html(""),e.length<=0||ajaxRequest(juzaweb.adminUrl+"/load-data/loadPostType",{search:e,per_page:5,post_type:a},{method:"GET",callback:function(e){let a="";return $.each(e.results,(function(e,i){a+=`<div class="form-check mt-1">\n                        <label class="form-check-label">\n                            <input class="form-check-input select-all-search-${t}" type="checkbox" name="items[]" value="${i.id}">\n                            ${i.text}\n                        </label>\n                    </div>`})),i.html(a),!1}}),!1})),$("#menu-container").on("keyup",".menu-box-taxonomy-search",(function(){let e=$(this).val(),t=$(this).data("key"),a=$(this).data("taxonomy"),i=$(this).closest(".tab-pane").find(".box-tab-search-result");return i.html(""),e.length<=0||ajaxRequest(juzaweb.adminUrl+"/load-data/loadTaxonomies",{search:e,per_page:5,taxonomy:a},{method:"GET",callback:function(e){let a="";return $.each(e.results,(function(e,i){a+=`<div class="form-check mt-1">\n                        <label class="form-check-label">\n                            <input class="form-check-input select-all-search-${t}" type="checkbox" name="items[]" value="${i.id}">\n                            ${i.text}\n                        </label>\n                    </div>`})),i.html(a),!1}}),!1}))})),$(document).on("turbolinks:load",(function(){let e=$("body");e.on("click",".install-plugin",(function(){let e=$(this).data("plugin"),t=$(this),a=t.html();t.prop("disabled",!0),t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),jwCMSUpdate("plugin",1,null,{plugin:e},(function(e){t.html(juzaweb.lang.activate),t.removeClass("install-plugin"),t.addClass("active-plugin"),t.prop("disabled",!1)}),(function(e){show_message(e),t.prop("disabled",!1),t.html(a)}))})),e.on("click",".active-plugin",(function(){let e=$(this).data("plugin"),t=$(this);t.prop("disabled",!0),ajaxRequest(juzaweb.adminUrl+"/plugins/bulk-actions",{ids:[e],action:"activate"},{method:"POST",callback:function(e){show_message(e),t.html(`<i class="fa fa-check"></i> ${juzaweb.lang.activated}`),t.removeClass("active-plugin"),t.prop("disabled",!0)},failCallback:function(e){show_message(e),t.prop("disabled",!1)}})}))})),$(document).on("turbolinks:load",(function(){let e=$("body");e.on("click",".update-theme",(function(){let e=$(this).data("theme"),t=$(this),a=t.html();t.prop("disabled",!0),t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),jwCMSUpdate("theme",1,null,{theme:e},(function(e){t.remove(),show_message(e)}),(function(e){t.prop("disabled",!1),t.html(a),show_message(e)}))})),e.on("click",".install-theme",(function(){let e=$(this).data("theme"),t=$(this),a=t.html();t.prop("disabled",!0),t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),jwCMSUpdate("theme",1,null,{theme:e},(function(e){t.html(juzaweb.lang.activate),t.removeClass("install-theme"),t.addClass("active-theme"),t.prop("disabled",!1)}),(function(e){show_message(e),t.prop("disabled",!1),t.html(a)}))})),e.on("click",".active-theme",(function(){let e=$(this).data("theme"),t=$(this);t.prop("disabled",!0),ajaxRequest(juzaweb.adminUrl+"/themes/activate",{theme:e},{method:"POST",callback:function(e){show_message(e),t.html(`<i class="fa fa-check"></i> ${juzaweb.lang.activated}`),t.removeClass("active-theme"),t.prop("disabled",!0)},failCallback:function(e){show_message(e),t.prop("disabled",!1)}})})),e.on("click",".delete-theme",(function(){let e=$(this).data("theme"),t=$(this),a=t.html();confirm_message(juzaweb.lang.delete_theme_confirm,(function(i){if(!i)return!1;t.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),ajaxRequest(juzaweb.adminUrl+"/themes/bulk-actions",{ids:[e],action:"delete"},{method:"POST",callback:function(e){show_message(e),1==e.status&&t.closest(".theme-list-item").remove()},failCallback:function(e){show_message(e),t.html(a)}})}))})),e.on("click",".buy-theme",(function(){let e=$(this),t=e.data("theme"),a=e.html();e.prop("disabled",!0),e.html('<i class="fa fa-spinner fa-spin"></i>'),ajaxRequest(juzaweb.adminUrl+"/module/theme/buy-modal",{module:t},{method:"GET",callback:function(t){$("#show-modal").empty().html(t.data.html),$("#show-modal .modal").modal(),e.html(a),e.prop("disabled",!1)},failCallback:function(t){show_message(t),e.html(a),e.prop("disabled",!1)}})})),e.on("submit","#form-activation-code, #form-select-key",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this),a=t.find("button[type=submit]"),i=t.find("input[name=module]").val(),n=t.find("[name=key]").val(),o=a.html();return!!n&&(a.prop("disabled",!0),a.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),ajaxRequest(juzaweb.adminUrl+"/module/theme/activation-code",{module:i,key:n},{method:"POST",callback:function(e){return!0!==e.status?(show_message(e),a.html(o),a.prop("disabled",!1),!1):(t.find("input[name=key]").closest(".form-group").hide(),a.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.installing),jwCMSUpdate("theme",1,null,{theme:i},(function(e){a.html(juzaweb.lang.activate),a.removeClass("install-theme"),a.addClass("active-theme"),a.data("theme",i),a.prop("disabled",!1)}),(function(e){show_message(e),a.prop("disabled",!1),a.html(o)})),!1)},failCallback:function(e){return show_message(e),a.html(o),a.prop("disabled",!1),!1}}),!1)})),e.on("submit","#form-login-juzaweb",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this),a=t.find("button[type=submit]"),i=t.find("input[name=module]").val(),n=t.find("input[name=email]").val(),o=t.find("input[name=password]").val(),s=a.html();return!(!n||!o)&&(a.prop("disabled",!0),a.html('<i class="fa fa-spinner fa-spin"></i> '+juzaweb.lang.please_wait),ajaxRequest(juzaweb.adminUrl+"/module/login-juzaweb",{module:i,email:n,password:o},{method:"POST",callback:function(e){return!0!==e.status?(show_message(e),a.html(s),a.prop("disabled",!1),!1):(ajaxRequest(juzaweb.adminUrl+"/module/theme/buy-modal",{module:i},{method:"GET",callback:function(e){$("#show-modal .modal").modal("hide"),$("#show-modal").empty().html(e.data.html),$("#show-modal .modal").modal()},failCallback:function(e){show_message(e),a.html(s),a.prop("disabled",!1)}}),!1)},failCallback:function(e){return show_message(e),a.html(s),a.prop("disabled",!1),!1}}),!1)}))})),$(document).on("turbolinks:load",(function(){initSelect2("body")}));class JuzawebTable{constructor(e){this.url=e.url,this.action_url=e.action_url,this.remove_url=e.remove_url||null,this.status_url=e.status_url||null,this.remove_question=e.remove_question?e.remove_question:juzaweb.lang.remove_question.replace(":name",juzaweb.lang.the_selected_items),this.detete_button=e.detete_button?e.detete_button:"#delete-item",this.status_button=e.status_button?e.status_button:".status-button",this.apply_button=e.apply_button?e.apply_button:"#apply-action",this.table=e.table?e.table:".juzaweb-table",this.field_id=e.field_id?e.field_id:"id",this.form_search=e.form_search?e.form_search:"#form-search",this.sort_name=e.sort_name?e.sort_name:"id",this.sort_order=e.sort_order?e.sort_order:"desc",this.page_size=e.page_size?e.page_size:10,this.search=!!e.search&&e.search,this.method=e.method?e.method:"get",this.locale=e.locale?e.locale:"en-US",this.chunk_action=!!e.chunk_action&&e.chunk_action,this.inputRow="",this.init()}init(){let e=$(this.apply_button),t=$(this.status_button),a=$(".bulk-actions-button");e.prop("disabled",!0),t.prop("disabled",!0),a.prop("disabled",!0);let i=$(this.table),n=this.form_search,o=this.action_url,s=this.remove_question,l=this.url,d=this.field_id,r=this.method,c=this.locale,u=this.status_url,m=this.chunk_action;i.bootstrapTable({url:l,idField:d,method:r,locale:c,sidePagination:"server",pagination:!0,sortName:this.sort_name,sortOrder:this.sort_order,toggle:"table",search:this.search,pageSize:this.page_size,queryParams:function(e){let t=$(n).serializeArray();return $.each(t,(function(t,a){e[a.name]?e[a.name]+=","+a.value:e[a.name]=a.value})),e}}),$(this.form_search).on("change","select, input",(function(e){return e.isDefaultPrevented()||(e.preventDefault(),i.bootstrapTable("refresh")),!1})),$(this.form_search).on("submit",(function(e){return e.isDefaultPrevented()||(e.preventDefault(),i.bootstrapTable("refresh")),!1})),i.on("check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table pre-body.bs.table",(()=>{!function(){let t=!i.bootstrapTable("getSelections").length;e.prop("disabled",t),a.prop("disabled",t)}()})),e.on("click",(function(){let e=$(this),t=e.closest("form"),a=e.html(),n=t.find("select[name=bulk_actions]").val(),l=t.find("input[name=_token]").val(),d=$("input[name=btSelectItem]:checked").map((function(){return $(this).val()})).get();if(!d||!n)return!1;if("delete"==n)confirm_message(s,(function(t){if(!t)return!1;e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),ajaxRequest(o,{ids:d,action:n,_token:l},{callback:function(t){return e.prop("disabled",!1),e.html(a),!0===t.status?(show_message(t),t.data.window_redirect?(window.location=t.data.window_redirect,!1):t.data.redirect?(setTimeout((function(){Turbolinks.visit(t.data.redirect,{action:"replace"})}),1e3),!1):(i.bootstrapTable("refresh"),$("select[name=bulk_actions]").val(null).trigger("change.select2"),!1)):(show_message(t),!1)}})}));else if(e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),m){let t=$("input[name=btSelectItem]:checked");setTimeout((function(){let s;process_each(t,(function(){let e=$(this).val();return $(this).hide(),$(this).closest("label").find("span").html('<i class="fa fa-spinner fa-spin"></i>'),s=ajaxRequest(o,{ids:[e],action:n,_token:l},{async:!1,callback:function(e){return!1}}),s}),500,{completeCallback:function(t){return show_message(t),t.data.redirect?(setTimeout((function(){Turbolinks.visit(t.data.redirect,{action:"replace"})}),1e3),!1):t.data.window_redirect?(setTimeout((function(){window.location=t.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(a),i.bootstrapTable("refresh"),void $("select[name=bulk_actions]").val(null).trigger("change.select2"))}})}),500)}else ajaxRequest(o,{ids:d,action:n,_token:l},{callback:function(t){return!0===t.status?(show_message(t),t.data.window_redirect?(window.location=t.data.window_redirect,!1):t.data.redirect?(setTimeout((function(){Turbolinks.visit(t.data.redirect,{action:"replace"})}),1e3),!1):t.data.window_redirect?(setTimeout((function(){window.location=t.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(a),i.bootstrapTable("refresh"),$("select[name=bulk_actions]").val(null).trigger("change.select2"),!1)):(show_message(t),!1)}});return!1})),$(".bulk-actions-actions").on("click",".select-action",(function(){let e=a,t=e.html(),n=$(this).data("action"),l=$(this).closest("form").find("input[name=_token]").val(),d=$("input[name=btSelectItem]:checked").map((function(){return $(this).val()})).get();if(a.dropdown("toggle"),!d||!n)return!1;if("delete"==n)confirm_message(s,(function(a){if(!a)return!1;e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),ajaxRequest(o,{ids:d,action:n,_token:l},{callback:function(a){return e.prop("disabled",!1),e.html(t),!0===a.status?(show_message(a),a.data.window_redirect?(window.location=a.data.window_redirect,!1):a.data.redirect?(setTimeout((function(){Turbolinks.visit(a.data.redirect,{action:"replace"})}),1e3),!1):(i.bootstrapTable("refresh"),!1)):(show_message(a),!1)}})}));else if(e.html(juzaweb.lang.please_wait),e.prop("disabled",!0),m){let a=$("input[name=btSelectItem]:checked");setTimeout((function(){let s;process_each(a,(function(){let e=$(this).val();return $(this).hide(),$(this).closest("label").find("span").html('<i class="fa fa-spinner fa-spin"></i>'),s=ajaxRequest(o,{ids:[e],action:n,_token:l},{async:!1,callback:function(e){return!1}}),s}),500,{completeCallback:function(a){return show_message(a),a.data.redirect?(setTimeout((function(){Turbolinks.visit(a.data.redirect,{action:"replace"})}),1e3),!1):a.data.window_redirect?(setTimeout((function(){window.location=a.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(t),void i.bootstrapTable("refresh"))}})}),500)}else ajaxRequest(o,{ids:d,action:n,_token:l},{callback:function(a){return!0===a.status?(show_message(a),a.data.window_redirect?(window.location=a.data.window_redirect,!1):a.data.redirect?(setTimeout((function(){Turbolinks.visit(a.data.redirect,{action:"replace"})}),1e3),!1):a.data.window_redirect?(setTimeout((function(){window.location=a.data.window_redirect}),1e3),!1):(e.prop("disabled",!1),e.html(t),i.bootstrapTable("refresh"),!1)):(show_message(a),!1)}});return!1})),t.on("click",(function(){let e=$("input[name=btSelectItem]:checked").map((function(){return $(this).val()})).get(),a=$(this).data("status");return e.length<=0||$.ajax({type:"POST",url:u,dataType:"json",data:{ids:e,status:a},success:function(e){return!0===e.status?(i.bootstrapTable("refresh"),t.prop("disabled",!0),$(".items-checked").prop("disabled",!0),!1):(show_message(e),!1)}}),!1})),i.on("click",".action-item",(function(){let e=[$(this).data("id")],t=$(this).data("action");return"delete"==t?Swal.fire({title:"",text:s,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:juzaweb.lang.yes+"!",cancelButtonText:juzaweb.lang.cancel+"!"}).then((a=>{a.value&&($(this).html(juzaweb.lang.please_wait),$.ajax({type:"POST",url:o,dataType:"json",data:{ids:e,action:t},success:function(e){return e.data.window_redirect?(show_message(e),window.location=e.data.window_redirect,!1):e.data.redirect?(show_message(e),setTimeout((function(){Turbolinks.visit(e.data.redirect,{action:"replace"})}),1e3),!1):void i.bootstrapTable("refresh")}}))})):($(this).html(juzaweb.lang.please_wait),$.ajax({type:"POST",url:o,dataType:"json",data:{ids:e,action:t},success:function(e){return e.data.window_redirect?(show_message(e),window.location=e.data.window_redirect,!1):e.data.redirect?(show_message(e),setTimeout((function(){Turbolinks.visit(e.data.redirect,{action:"replace"})}),1e3),!1):void i.bootstrapTable("refresh")}})),!1}))}refresh(e={}){e?$(this.table).bootstrapTable("refreshOptions",e):$(this.table).bootstrapTable("refresh",e)}}class JuzawebListView{constructor(e){this.url=e.url,this.list=e.list?e.list:".juzaweb-list",this.method=e.method?e.method:"get",this.template=e.template?e.template:null,this.sort_name=e.sort_name?e.sort_name:"id",this.sort_order=e.sort_order?e.sort_order:"desc",this.page_size=e.page_size?e.page_size:10,this.after_load_callback=e.after_load_callback?e.after_load_callback:null,this.item_formatter=e.item_formatter?e.item_formatter:null,this.offset=0,this.total=0,this.page=1,this.init()}init(){let e=this;e.loadData(),$(window).scroll((function(){$(window).scrollTop()===$(document).height()-$(window).height()&&e.offset+e.page_size<e.total&&(e.page=e.page+1,e.loadData())}))}loadData(){let template=this.template?document.getElementById(this.template).innerHTML:null,result=$(this.list),itemFormatter=this.item_formatter;this.page>1&&(this.offset=this.page*this.page_size-this.page_size);let jqxhr=$.ajax({type:this.method,url:this.url,dataType:"json",cache:!1,async:!1,data:{page:this.page,limit:this.page_size}}),response=jqxhr.responseJSON;this.total=response.meta.total;let html="";response.data.length>0&&($.each(response.data,(function(index,item){itemFormatter?html=eval(itemFormatter)(index,item):html+=replace_template(template,item)})),result.append(html)),this.after_load_callback&&eval(this.after_load_callback)()}}function addStyleSubmenu(e){var t,a=e.find(".juzaweb__menuLeft__navigation"),i=(n=e.offset().top)-(t=$(window).scrollTop())-30,n=60+(e=n+a.height()+1)-$(".juzaweb__layout").height();(n=i<(n=(t=$(window).height()+t-50)<e-n?e-t:n)?i:n)>1&&n>40?a.css("margin-top","-"+n+"px"):a.css("margin-top","")}$(document).on("turbolinks:load",(function(){function validate_isNumberKey(e){let t=e.which?e.which:event.keyCode;return 59==t||46==t||!(t>31&&(t<48||t>57))}function validate_FormatNumber(e){e.value=e.value.replace(/\,/gi,""),e.value=e.value.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}$("body").on("submit",".form-ajax",(function(event){if(event.isDefaultPrevented())return!1;event.preventDefault();var form=$(this),formData=new FormData(form[0]),btnsubmit=form.find("button[type=submit]"),currentIcon=btnsubmit.find("i").attr("class"),currentText=btnsubmit.html(),submitSuccess=form.data("success");btnsubmit.find("i").attr("class","fa fa-spinner fa-spin"),btnsubmit.prop("disabled",!0),btnsubmit.data("loading-text")&&btnsubmit.html('<i class="fa fa-spinner fa-spin"></i> '+btnsubmit.data("loading-text")),$.ajax({type:form.attr("method"),url:form.attr("action"),dataType:"json",data:formData,cache:!1,contentType:!1,processData:!1}).done((function(response){return show_message(response),submitSuccess&&eval(submitSuccess)(form,response),response.data.redirect?(setTimeout((function(){Turbolinks.visit(response.data.redirect,{action:"replace"})}),1e3),!1):(btnsubmit.find("i").attr("class",currentIcon),btnsubmit.prop("disabled",!1),btnsubmit.data("loading-text")&&btnsubmit.html(currentText),response.status,!1)})).fail((function(e){return btnsubmit.find("i").attr("class",currentIcon),btnsubmit.prop("disabled",!1),btnsubmit.data("loading-text")&&btnsubmit.html(currentText),show_message(e),!1}))})),$("body").on("click",".load-modal",(function(e){if(e.isDefaultPrevented())return!1;e.preventDefault();let t=$(this).data(),a=$(this),i=a.find("i").attr("class");a.find("i").attr("class","fa fa-spinner fa-spin"),a.prop("disabled",!0),a.addClass("disabled");let n="";$.each(t,(function(e,t){"url"!==e&&(n+="&"+e+"="+t)}));let o=$(this).data("url");n&&(o=o+"?"+n),$.ajax({type:"GET",url:o,dataType:"json",data:{},cache:!1,contentType:!1,processData:!1}).done((function(e){return a.find("i").attr("class",i),a.prop("disabled",!1),a.removeClass("disabled"),!1===e.status||($("#show-modal").html(e.data.source),$("#show-modal .modal").modal()),!1})).fail((function(e){return a.find("i").attr("class",i),a.prop("disabled",!1),!1}))})),$("body").on("keypress",".is-number",(function(){return validate_isNumberKey(this)})),$("body").on("keyup",".number-format",(function(){return validate_FormatNumber(this)}))})),$(document).on("turbolinks:load",(function(){$(".form-taxonomy").on("click",".add-new",(function(){let e=$(this).closest(".form-taxonomy").find(".form-add");e.is(":visible")?e.hide("slow"):e.show("slow")})),$("body").on("change",".select-tags",(function(){let e=$(this),t=e.val(),a=e.data("taxonomy"),i=e.data("type");$.ajax({type:"GET",url:juzaweb.adminUrl+"/taxonomy/"+i+"/"+a+"/component-item",dataType:"json",data:{id:t}}).done((function(t){return!1===t.status?(show_message(t),!1):(e.closest(".form-taxonomy").find(".show-tags").append(t.data.html),e.val(null).trigger("change.select2"),!1)})).fail((function(e){return show_message(e),!1}))})),$("body").on("click",".remove-tag-item",(function(){$(this).closest(".tag").remove()})),$("body").on("click",".form-add-taxonomy button",(function(){let e=$(this),t=e.closest(".form-add"),a=t.find(".taxonomy-name").val(),i=t.find(".taxonomy-parent").val(),n=e.data("type"),o=e.data("taxonomy"),s=e.data("post_type"),l=e.find("i").attr("class");e.find("i").attr("class","fa fa-spinner fa-spin"),e.prop("disabled",!0),$.ajax({type:"POST",url:juzaweb.adminUrl+"/taxonomy/"+n+"/"+o,dataType:"json",data:{name:a,parent_id:i,post_type:s,taxonomy:o}}).done((function(a){return e.find("i").attr("class",l),e.prop("disabled",!1),!1===a.status?(show_message(a),!1):(e.closest(".form-taxonomy").find(".show-tags").append(a.data.html),t.find(".taxonomy-name").val(""),i&&t.find(".taxonomy-parent").val(null).trigger("change.select2"),!1)})).fail((function(t){return e.find("i").attr("class",l),e.prop("disabled",!1),show_message(t),!1}))}))})),$(document).on("turbolinks:load",(function(){let e=$("body");e.on("change",".show_on_front-change",(function(){let e=$(this).val();"posts"==e&&$(".select-show_on_front").prop("disabled",!0),"page"==e&&$(".select-show_on_front").prop("disabled",!1)})),e.on("click",".cancel-button",(function(){window.location=""})),e.on("change",".generate-slug",(function(){let e=$(this).val();ajaxRequest(juzaweb.adminUrl+"/load-data/generateSlug",{title:e},{method:"GET",callback:function(e){$("input[name=slug]").val(e.slug).trigger("change")}})})),e.on("click",".slug-edit",(function(){let e=$(this).closest(".input-group").find("input:first");e.prop("readonly",!e.prop("readonly"))})),e.on("click",".close-message",(function(){let e=$(this).data("id");ajaxRequest(juzaweb.adminUrl+"/remove-message",{id:e},{method:"POST",callback:function(e){}})})),$(".juzaweb__menuLeft__submenu").on("mouseover",(function(){$(this).hasClass("juzaweb__menuLeft__submenu--toggled")||addStyleSubmenu($(this))}))})),$(document).on("turbolinks:load",(function(){})),$(document).on("turbolinks:load",(function(){let e=new URLSearchParams(window.location.search).get("template");e&&$('select[name="meta[template]"]').val(e).trigger("change"),$("body").on("click",".show-form-block",(function(){let e=$(this).closest(".dd-item").find(".form-block-edit");e.is(":hidden")?e.show("slow"):e.hide("slow")})),$("body").on("click",".remove-form-block",(function(){$(this).closest(".dd-item").remove()})),$("body").on("change",'select[name="meta[template]"]',(function(){let e=$(this).val();if(!e)return!1;let t=window.location.href;t=t.split("?")[0],Turbolinks.visit(t+"?template="+e,{action:"replace"})})),$("body").on("click",".add-block-data",(function(){let e=$(this).data("block"),t=$(this).data("content_key"),a=$(this),i=document.getElementById("block-"+e+"-template").innerHTML,n=(new Date).getTime();i=replace_template(i,{marker:n,content_key:t}),a.closest(".page-block-content").find(".dd-empty").remove(),a.closest(".page-block-content").find(".dd-list").append(i),initSelect2("#page-block-"+n)}))}));
